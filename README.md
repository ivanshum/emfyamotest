# Тестовое задание на вакансию Frontend-разработчика в Emfy.

## Подготовка:

Зарегистрировать аккаунт в https://www.amocrm.ru/ Зайти в раздел амоМаркет (/amo-market/).Нажать на 3 точки в правом верхнем углу - создать "Внешнюю интеграцию" для доступа к amoCRM по API. Документация по созданию интеграций, методам API и получению ключей oAuth - https://www.amocrm.ru/developers/

Получить access_token для доступа по API к аккаунту amoCRM можно с помощью authorization_code во вкладке "Ключи и доступы" во вновь созданной интеграции. Для этого достаточно отправить необходимые запросы на получение access_token из консоли разработчика. Обратите внимание что ключи нужно получить именно через authorization_code, а не использовать долгосрочный токен доступа.

Далее необходимо в разделе "Сделки" создать минимум 6 сделок, в которых поле "Бюджет" заполнить случайными суммами (сделать можно вручную, а не по API). После этого перейдите из раздела "Сделки" в карточки созданных вами сделок и добавьте к каждой сделке по задаче(в нижней части интерфейса есть область, откуда добавляются примечания, задачи и чаты), датой указав один из следующих вариантов(каждый должен встретиться хотябы 1 раз среди всех сделок): Вчера, Сегодня, Завтра. В 5 из 6 карточек сделки добавьте контакт(в карточке контакта в левой части под полями бюджет и ответственный будет соответствующая кнопка) и укажите в нём любой номер телефона. После этого необходимо разработать скрипт для выполнения тестового задания.

## Тестовое задание:

ВАЖНО. Тестовое задание должно быть выполнено полностью на frontend в виде отдельно сверстанной страницы без использования backend.
Нам важны знания разработчиком чистого JavaScript, поэтому использовать фреймворки нельзя. Для удобства и стилизации разрешается использовать bootstrap.
Для обхода CORS-политики можете использовать локальный или внешний прокси сервер, либо плагин для браузера.

1. Сверстайте основную страницу вашего проекта. Она должна быть выполнена в виде таблицы со сделками.
2. Далее вам необходимо получить все созданные карточки сделок и связанные с ними карточки контактов по API и вывести их на
   созданную вами страничку в виде отдельной строчки в таблице для каждой пары контакта и сделки.
   Нужно вывести их id, название сделки, бюджет, название контакта и номер телефона.
3. При обращении к API получайте не более 2х карточек раз в секунду. Это очень важно,
   так как amoCRM имеет ограничение. Несомненно, оно больше чем 2 карточки, но это
   нужно для проверки навыков.
4. При нажатии на карточку, выводит на месте карточки загрузку и получаем
   развернутые данные по API.
   При этом, если есть открытая карточка, то она должна закрываться.
   После получения данных от сервера убираем спиннер и вставляем в эту же карточку
   название, id, дату в формате DD.MM.YYYY, статус ближайщей задачи.
   Статус должен является тегом svg и представлять собой раскрашенный в цвет статуса
   круг:
   Если нет задачи или она просрочена(поставлена на вчера), то круг должен быть красным.
   Если задача будет в этот день, то зеленым.
   Если более чем через день, то желтым.

## Чтобы получить токен используем команду:

```bash
curl https://ivanivanshumshumilov.amocrm.ru/oauth2/access_token -d \
'{"client_id":"<Id интеграции>","client_secret":"<Секретный ключ>","grant_type":"authorization_code","code":"<Код авторизации>","redirect_uri":"https://ivanivanshumshumilov.amocrm.ru/"}' \
-H 'Content-Type:application/json' \
-X POST
```

Токены лежат в .env в репозитории. Если ACCESSTOKEN протух, то можно воспользоваться рефрешем, ну или передернуть интеграцию и получить заново
Хранить в репе не стоит конечно, но для теста можно.
В принципе можно сделать и долгоживущий токен, но так обычно лучше, чтобы избежать утечки.

## Запуск проекта

```bash
# Use line below if corepack isn't already enabled
corepack enable
yarn install
yarn dev
```

открыть http://localhost:5173/ в браузере
